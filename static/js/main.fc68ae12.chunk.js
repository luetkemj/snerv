(this.webpackJsonpsnerv=this.webpackJsonpsnerv||[]).push([[0],{19:function(e,t,r){e.exports=r(32)},30:function(e,t,r){},31:function(e,t,r){},32:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),c=r(8),a=r.n(c),i=r(6),s=r(18),l=r(2),p=r(5),u=r(3),y="PLAYER_MOVE",f="ADD_SPRITES",O="UPDATE_SPRITES",b="UPDATE_WORLD",d="ADD_NEW_LOG";function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(r,!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g={logs:[]},h=r(1);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S={spriteIds:[],spritesMap:{}};function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(r,!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=function(e,t){switch(t){case"N":return E({},e,{row:e.row-1});case"NE":return{col:e.col+1,row:e.row-1};case"E":return E({},e,{col:e.col+1});case"SE":return{col:e.col+1,row:e.row+1};case"S":return E({},e,{row:e.row+1});case"SW":return{col:e.col-1,row:e.row+1};case"W":return E({},e,{col:e.col-1});case"NW":return{col:e.col-1,row:e.row-1};default:return e}},A=function(e){return"".concat(e.col,",").concat(e.row)};function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(r,!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M={cols:60,rows:40,layers:{layerGround:{},layerBelow:{},layerAt:{},layerAbove:{},layerSky:{}},claimedLocations:{}},W=Object(l.combineReducers)({gamelogState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return j({},e,{logs:[t.payload].concat(Object(p.a)(e.logs))});default:return e}},spritesState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return m({},e,{spritesMap:m({},e.spritesMap,{},Object(h.keyBy)(t.payload.sprites,"id"))});case f:var r=Object(h.uniq)(e.spriteIds.concat(t.payload.map((function(e){return e.id})))),n=m({},e.spritesMap,{},Object(h.keyBy)(t.payload,"id"));return m({},e,{spriteIds:r,spritesMap:n});default:return e}},worldState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:var r=Object(h.cloneDeep)(e.layers);return t.payload.forEach((function(e){return r[e.layer][A(e)]=e.id})),N({},e,{layers:r});case b:return N({},e,{layers:t.payload,claimedLocations:{}});case O:return N({},e,{claimedLocations:t.payload.claimedLocations});default:return e}}}),L=Object(s.a)({reducer:W}),R=(r(30),r(17)),T=10,x=10,I=10,_=x*T,B=I*T;function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(r,!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var U=0;function G(e,t){return function(r){return r({type:O,payload:{sprites:e,claimedLocations:t}})}}function J(e){return function(t,r){var n=Y({},r().worldState.claimedLocations);t(G(e.map((function(e){var o,c=e.sprite,a=e.dir,i=c.col,s=c.row,l=D({col:i,row:s},a),p=A(l),u=r().worldState.layers[e.sprite.layer][p],y=r().spritesState.spritesMap[u];return l.col<0?c:l.col===x?c:l.row<0?c:l.row===I?c:u&&y.noClip?(c.type!==y.type&&t((o=y,function(e){e({type:"ATTACK"}),"MONSTER"===o.type&&e({type:d,payload:{text:"You attack and kill the monster!"}}),"PLAYER"===o.type&&e({type:d,payload:{text:"The monster kills you!"}}),e(G([Y({},o,{health:0})]))})),c):n[p]?c:(n[p]=p,Y({},c,{},l))})),n))}}function K(e){return function(t){t({type:y}),t(function(e){return function(t,r){var n=r().spritesState.spritesMap[1];n.health<=0||t(J([{sprite:n,dir:e}]))}}(e)),t((function(e,t){var r=Object(h.filter)(t().spritesState.spritesMap,(function(e){return"MONSTER"===e.type&&e.health>0})),n=["N","NE","E","SE","S","SW","W","NW"];e(J(r.map((function(e){return{sprite:e,dir:n[Math.floor(Math.random()*n.length)]}}))))})),t((function(e,t){var r=t().worldState.layers,n={};Object(h.forEach)(r,(function(e,r){n[r]={},Object(h.forEach)(e,(function(e){var o=t().spritesState.spritesMap[e],c=A(o);n[r][c]=e}))})),e({type:b,payload:n})}))}}r(31);var q=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.spritesState.spritesMap})),r=Object(i.c)((function(e){return e.worldState.layers.layerAt})),c=Object(i.c)((function(e){return e.gamelogState.logs}));Object(n.useEffect)((function(){var t;e(((t=[{type:"PLAYER",col:2,row:2,layer:"layerAt",noClip:!0,health:1}].concat(Object(p.a)(Array.from(Array(10)).map((function(e){return{type:"MONSTER",col:Object(h.random)(0,x-1),row:Object(h.random)(0,I-1),layer:"layerAt",noClip:!0,health:1}}))))).forEach((function(e){e.id=++U})),function(e){return e({type:f,payload:t})}))}),[e]);var a=function(t){e(K(t))},s=function(e){var t=e.key;["ArrowUp","8","w"].includes(String(t))&&a("N"),["9"].includes(String(t))&&a("NE"),["ArrowRight","6","d"].includes(String(t))&&a("E"),["3"].includes(String(t))&&a("SE"),["ArrowDown","2","s"].includes(String(t))&&a("S"),["1"].includes(String(t))&&a("SW"),["ArrowLeft","4","a"].includes(String(t))&&a("W"),["7"].includes(String(t))&&a("NW")};return Object(R.a)("keydown",s),o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"game",onKeyDown:s,style:{width:_,height:B}},Object.keys(r).map((function(e){var n=r[e];return o.a.createElement("span",{key:n,className:"sprite ".concat(t[n].type," ").concat(t[n].health<1?"dead":""),style:{width:T,height:T,transform:"translate(".concat(t[n].col*T,"px, ").concat(t[n].row*T,"px)")},role:"img","aria-label":"".concat(t[n].type,"-sprite")})}))),o.a.createElement("div",{className:"gamelog"},c.map((function(e,t){return o.a.createElement("p",{key:t},e.text)}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(i.a,{store:L},o.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[19,1,2]]]);
//# sourceMappingURL=main.fc68ae12.chunk.js.map